(function(o,v,l,w,x){o.fn.image8bit=function(b){b=o.extend({blocksize:5,granularity:16},b);o(this).each(function(){var p=o(this),y=p[0],q=p.width(),r=p.height(),m=v.createElement(w),g=v.createElement(w),t,h,i,d,e,a,n,j,f,k,c,u,s;if(m.getContext&&y.tagName==="IMG"){m.width=q;m.height=r;t=m.getContext(x);g.width=g.height=1;g=g.getContext(x);for(d=0;d<r;d+=b.blocksize)for(e=0;e<q;e+=b.blocksize){h=i=b.blocksize;h=h+e>q?q-e:h;i=i+d>r?r-d:i;g.drawImage(y,e,d,h,i,0,0,1,1);try{a=g.getImageData(0,0,1,1).data}catch(z){window.console&&
window.console.log&&console.log(z.message);return}j=a[0]/255;f=a[1]/255;k=a[2]/255;a=l.max(j,f,k);n=l.min(j,f,k);c=u=0;s=(a+n)/2;if(a!==n){c=a-n;u=s>0.5?c/(2-a-n):c/s*2;switch(a){case j:c=(f-k)/c+(f<k?6:0);break;case f:c=(k-j)/c+2;break;default:c=(j-f)/c+4}}a=[l.round(c/6/b.granularity*100)*b.granularity*3.6,l.round(u/b.granularity*100)*b.granularity+"%",l.round(s/b.granularity*100)*b.granularity];t.fillStyle="hsl("+a.join(",")+"%)";t.fillRect(e,d,h,i)}p.replaceWith(m)}})}})(jQuery,document,Math,
"canvas","2d");
